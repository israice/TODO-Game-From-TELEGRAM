# Auto Browser

Telegram-бот для автоматизации рутинных действий в браузере через Playwright.

## 📋 Описание

Проект предоставляет интерфейс для управления задачами в TODO-приложении через Telegram. Бот принимает команды от пользователя, запускает браузерные скрипты и выполняет действия автоматически.

## 🔧 Возможности

| Действие | Описание |
|----------|----------|
| 📝 Добавить задание | Создание новой задачи с указанным текстом |
| 🗑️ Удалить задание | Удаление задачи по номеру из списка |
| ✏️ Переименовать | Изменение названия задачи |
| ✅ Выполнить | Отметка задачи как выполненной |

## 🚀 Как это работает

```
┌─────────────────────────────────────────────────────────┐
│  Telegram Bot (run.js)                                  │
│  • Принимает команды от пользователя                    │
│  • Управляет сессиями (состояние пользователя)          │
│  • Вызывает task-модули напрямую                        │
└─────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────┐
│  Browser Service (browser.js)                           │
│  • Единый Playwright клиент                             │
│  • login(), getTasks(), addTask(), ...                  │
└─────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────┐
│  Task Modules (tasks/*.js)                              │
│  • get.js — получение списка задач                      │
│  • add.js — добавление задачи                           │
│  • delete.js — удаление задачи                          │
│  • rename.js — переименование задачи                    │
│  • complete.js — завершение задачи                      │
└─────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────┐
│  Веб-приложение (todo.weforks.org)                      │
│  • Автоматизация через браузер Chromium                 │
│  • Эмуляция действий пользователя                       │
└─────────────────────────────────────────────────────────┘
```

## 📦 Установка

1. **Клонируйте репозиторий:**
   ```bash
   git clone <repository-url>
   cd auto-browser
   ```

2. **Установите зависимости:**
   ```bash
   npm install
   ```

3. **Настройте переменные окружения:**
   ```bash
   # Скопируйте пример
   copy .env.example .env

   # Отредактируйте .env и укажите:
   TELEGRAM_BOT_TOKEN=ваш_токен_бота
   TODO_USERNAME=логин_todo
   TODO_PASSWORD=пароль_todo
   ```

4. **Установите браузеры Playwright:**
   ```bash
   npx playwright install chromium
   ```

## ▶️ Запуск

```bash
node run.js
```

После запуска бот будет ожидать команды в Telegram.

## 📱 Использование в Telegram

1. **Запуск бота:** Отправьте `/start`
2. **Выберите действие** из меню кнопок
3. **Следуйте инструкциям** бота:
   - Для **добавления** — введите текст задачи
   - Для **удаления/выполнения** — выберите номер из списка
   - Для **переименования** — введите номер, затем новое имя

### Пример диалога

```
Вы: /start
Бот: Выберите действие: [📝] [🗑️] [✏️] [✅]

Вы: [нажали 🗑️ Удалить задание]
Бот: 📋 Загружаю список задач...
Бот: 📝 Ваши задачи:
     1. Купить молоко
     2. Выгулять собаку
     3. Сделать уборку

     Введите номер:

Вы: 2
Бот: ✅ Выполняю...
Бот: ✅ Готово!
```

## 📁 Структура проекта

```
auto-browser/
├── run.js              # Telegram бот
├── config.js           # Вся конфигурация (селекторы, URL, задержки, сообщения)
├── browser.js          # Playwright сервис (login, getTasks, addTask, ...)
├── tasks/
│   ├── get.js          # Получение списка задач
│   ├── add.js          # Добавление задачи
│   ├── delete.js       # Удаление задачи
│   ├── rename.js       # Переименование задачи
│   └── complete.js     # Завершение задачи
├── telegram/           # (служебные файлы, опционально)
├── .env                # Переменные окружения
└── package.json        # Зависимости
```

## ⚙️ Конфигурация

Вся конфигурация в `config.js`:

```javascript
module.exports = {
  telegram: {
    buttons: { ... },      // Названия кнопок
    actions: { ... },      // Внутренние имена действий
    messages: { ... }      // Сообщения бота
  },
  browser: {
    headless: false,
    loginUrl: 'https://todo.weforks.org/',
    loginTimeout: 10000
  },
  login: { ... },          // Селекторы формы входа
  tasks: { ... },          // Селекторы элементов задач
  delays: { ... },         // Задержки между действиями (ms)
  credentials: { ... }     // Учётные данные из .env
};
```

## 🔍 Отладка

Включите подробное логирование в консоли:
- Сессии пользователей
- Загруженные списки задач
- Результаты выполнения скриптов

## 📝 Зависимости

- [telegraf](https://telegraf.js.org/) — фреймворк для Telegram-ботов
- [playwright](https://playwright.dev/) — автоматизация браузера
- [dotenv](https://github.com/motdotla/dotenv) — управление переменными окружения

## ⚠️ Примечания

- Бот работает только с одним пользователем одновременно (сессии в памяти)
- Для работы требуется запущенный Node.js процесс
- Браузер открывается в видимом режиме (`headless: false` по умолчанию)

## 📄 Лицензия

MIT
